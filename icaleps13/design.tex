\section{DESIGN}

Introduction to the chapter

\subsection{White Rabbit}

White Rabbit (WR~\cite{wr}) is a project which aims at creating
an Ethernet-based network with low-latency, deterministic
packet delivery and network-wide, transparent, high-accuracy
timing distribution. The White Rabbit Network (WRN) is
based on existing standards: Ethernet (IEEE 802.3~\cite{internet}),
Synchronous Ethernet (SyncE~\cite{sync}) and PTP~\cite{ptp}. 

A WRN consists of White Rabbit Nodes (nodes) and White
Rabbit Switches (switches) interconnected by fiber optics links. 
A node is considered the source and destination of information sent 
over the WRN. The information distributed over a WRN includes:

\begin{itemize}
    \item Timing - frequency and International Atomic Time.
    \item Data - Ethernet traffic between nodes.
\end{itemize}

\textit{to be finished}

\subsection{Timing System}

\subsubsection{Data Master}

Mathias

\subsubsection{Timing Master}

Cesar

\subsubsection{Management Master}

At startup, the WR networking devices need essential configuration parameters (e.g. ip
address). During operation, the network has to be constantly monitored in
order to prevent, identify and solve malfunctions or breakdowns of devices. 
These tasks are carried out by specialized software (e.g DHCP) installed in the
so-called WR Management Master (WR MM). 

In the current WRN the MM is also a gateway between the corporative, timing and management 
network. All the WR switches are connected either to management and timing
network, while the WR nodes are only to the timing network. 

Currently the MM is serving ip addresses to the management port of switches and WR
nodes using BOOTP~\cite{bootp}. Information about the status of the network (e.g.
link up/down, synchronization status etc...)is gathered in the MM using Distributed Information Managment
tool. Finally, the WR Switches can boot using a NFS server in the MM for testing
purposes. 

In the future the MM will offer advance management and monitoring capabilities
using the SNMP~\cite{snmp} and sFlow~\cite{sflow}. These tools will allow to the 
WR network manager to anticipate networks problems and maintain the reliability
and robustness required for the timing system.


\subsubsection{Timing Network}

Cesar

\subsubsection{Timing Receiver Nodes}


\textbf{Form Factors}

\textbf{SCU}
The biggest number of timing receivers will be build in the formfactor
of the SCU (Scalable Control Unit).
It is planned to run around 1200 units in FAIR.
The SCU is a combination of a carrier board with an Arria II FPGA and a
COMExpress board running
linux. The communication between FPGA and COMExpress board is done via
PCIe. The carrier board is
equipped with the circuitry for White Rabbit, a DDR3 memory for support
of a soft cpu
and a parallel flash for text memory. Two SFP slots are available, one
is used for White Rabbit, one for future
use. Also available are several IOs as LEMO, EIA232, USB and Ethernet.

The SCU controls up to 12 slave cards via the SCU bus. For a smaller
number of slaves a backplane with
only 5 slots exists. So two SCUs can be run in one 19 inch crate.
The main use cases in FAIR for the SCU is the control of the ACU
(Adaptive Control Unit) for ramped power suplies,
control of radio frequency devices with FIB (FPGA Interface Board) and
the control of kicker modules
via MIL extension board.

\textbf{PEXARRIA}
Wesley

\textbf{EXPLODER}
Wesley

\textbf{VME}
Cesar


\textbf{common design SoC}
Wesley


\textbf{eca, tlu}
Wesley


\textbf{etherbone slave}
Wesley


\textbf{uniform access from pcie,vme,usb,ethernet}
Wesley


